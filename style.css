@import url('https://fonts.googleapis.com/css2?family=Merriweather:wght@700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap');

/* Global Styles */
html, body, .main {
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg, #a6d3ff 50%, #cbdff7 100%);
    color: #2c3e50;
    animation: fadeIn 1s ease-in-out;
    overflow-x: hidden;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

@keyframes slideIn {
    from { transform: translateY(-10px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

/* Professional button styling */
.stButton > button {
    background: linear-gradient(135deg, #a6d3ff 50%, #cbdff7 100%);
    color: white !important;
    padding: 12px 25px;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-size: 17px;
    font-weight: 600;
    transition: all 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 77, 168, 0.3);
    letter-spacing: 0.5px;
}

.stButton > button:hover {
    background: linear-gradient(135deg, #004DA8 25%, #1e88e5 50%);
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 6px 18px rgba(0, 77, 168, 0.4);
    filter: brightness(1.05);
    color: white !important;
}

.stButton > button:active {
    transform: translateY(0);
    box-shadow: 0 4px 12px rgba(0, 77, 168, 0.3);
    color: white !important;
}

/* Input focus styling overrides */
input:focus, select:focus, textarea:focus {
    outline: none !important;
    box-shadow: none !important;
    border: 1px solid #ccc !important;
}

input:invalid, select:invalid {
    border: 1px solid #ccc !important;
}

/* Professional expander styling */
.streamlit-expander > div[role="button"] {
    background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%) !important;
    border-left: 6px solid #004DA8 !important;
    padding: 12px 15px;
    border-radius: 10px;
    margin-bottom: 8px;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0, 77, 168, 0.1);
    font-weight: 500;
    color: #1a1a1a !important;
    font-family: 'Montserrat', sans-serif;
    font-size: 1.05em;
}

.streamlit-expander > div[role="button"]:hover {
    background: linear-gradient(135deg, #bbdefb 0%, #90caf9 100%) !important;
    transform: translateX(5px);
    box-shadow: 0 3px 8px rgba(0, 77, 168, 0.2);
    color: #1a1a1a !important;
}

.streamlit-expander .streamlit-expanderContent {
    background-color: #ffffff;
    border-radius: 0 0 10px 10px;
    padding: 20px;
    margin-top: -8px;
    border: 1px solid #e3f2fd;
    border-top: none;
    box-shadow: 0 2px 8px rgba(0, 77, 168, 0.05);
    color: #2c3e50 !important;
}

/* Professional header styling */
h1 {
    font-family: 'Montserrat', sans-serif !important;
    color: #004DA8 !important;
    font-size: 2.5rem;
    font-weight: 750;
    margin-top: 1.8em;
    margin-bottom: 0.8em;
    text-shadow: 1px 1px 2px rgba(0, 77, 168, 0.1);
    animation: slideIn 0.8s ease-out;
}

h2, h3, h4, h5, h6 {
    font-family: 'Montserrat', sans-serif !important;
    color: #004DA8 !important;
    font-weight: 700;
    margin-top: 1.8em;
    margin-bottom: 0.8em;
    text-shadow: 1px 1px 2px rgba(0, 77, 168, 0.1);
    animation: slideIn 0.8s ease-out;
}

/* Professional metric styling */
.stMetric {
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
    border-radius: 12px;
    padding: 20px;
    box-shadow: 0 4px 15px rgba(0, 77, 168, 0.1);
    text-align: center;
    transition: all 0.3s ease;
    margin-bottom: 15px;
    border: 1px solid #e0e0e0;
}

.stMetric:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0, 77, 168, 0.15);
    background: linear-gradient(135deg, #f8fbff 0%, #e3f2fd 100%);
}

.stMetric [data-testid="metric-container"] > div:first-child {
    font-size: 1.1em;
    color: #004DA8 !important; /* Corrected for visibility */
    font-weight: 500;
}

.stMetric [data-testid="metric-container"] > div:nth-child(2) {
    font-size: 2.2em;
    font-weight: bold;
    color: #004DA8 !important; /* Corrected for visibility */
    margin-top: 5px;
}

/* Professional inline code styling */
.stMarkdown code {
    background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
    color: #004DA8 !important;
    border-radius: 5px;
    padding: 3px 6px;
    font-family: 'Source Code Pro', monospace;
    font-size: 0.9em;
    border: 1px solid #e0e0e0;
}

/* Professional dataframe styling */
.stDataFrame table {
    font-family: 'Roboto', sans-serif;
    width: 100%;
    border-collapse: collapse;
    margin-top: 25px;
    box-shadow: 0 5px 15px rgba(0, 77, 168, 0.1);
    border-radius: 12px;
    overflow: hidden;
    background-color: white;
    border: 1px solid #e3f2fd;
}

.stDataFrame thead th {
    background: linear-gradient(135deg, #004DA8 0%, #1976d2 100%);
    color: white !important;
    padding: 15px 20px;
    text-align: left;
    border-bottom: 2px solid #1565c0;
    font-weight: 700;
    font-size: 1.05em;
}

.stDataFrame tbody td {
    padding: 12px 20px;
    border-bottom: 1px solid #e3f2fd;
    font-size: 0.95em;
    color: #2c3e50 !important;
}

.stDataFrame tbody tr:nth-child(even) {
    background: linear-gradient(135deg, #f8fbff 0%, #ffffff 100%);
}

.stDataFrame tbody tr:hover {
    background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
}

/* Professional alert styling */
.stAlert[data-baseweb="notification"] {
    border-radius: 8px;
    padding: 15px;
    margin: 10px 0;
}

.stAlert[data-baseweb="notification"][kind="success"] {
    background: linear-gradient(135deg, #e8f5e8 0%, #d4edda 100%);
    color: #155724 !important;
    border-left: 5px solid #28a745;
}

.stAlert[data-baseweb="notification"][kind="warning"] {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
    color: #856404 !important;
    border-left: 5px solid #ffc107;
}

.stAlert[data-baseweb="notification"][kind="info"] {
    background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
    color: #004DA8 !important;
    border-left: 5px solid #004DA8;
}

.stAlert[data-baseweb="notification"][kind="error"] {
    background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
    color: #721c24 !important;
    border-left: 5px solid #dc3545;
}

/* Professional text input styling */
.stTextInput label {
    font-weight: 600;
    color: #2c3e50 !important;
}

.stTextInput input {
    border-radius: 8px;
    border: 1px solid #e0e0e0;
    padding: 8px 12px;
    transition: all 0.2s ease;
    color: #14212e !important;
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
}

.stTextInput input:focus {
    border-color: #e0e0e0;
    box-shadow: 0 0 0 0.2rem rgba(0, 77, 168, 0.25);
    outline: none;
    background: white;
}

.stTextInput input::placeholder {
    color: #6c757d !important;
}

/* Professional multiselect styling */
.stMultiSelect label {
    font-weight: 600;
    color: #2c3e50 !important;
}

.stMultiSelect > div > div {
    border-radius: 8px;
    border: 1px solid #e0e0e0;
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
}

.stMultiSelect > div > div:focus-within {
    border-color: #e0e0e0;
    box-shadow: 0 0 0 0.2rem rgba(0, 77, 168, 0.25);
    background: white;
}

.stMultiSelect [data-baseweb="tag"] {
    background: linear-gradient(135deg, #6d96c7 0%, #a6d3ff 50%, #cbdff7 100%);
    color: white !important;
    border-radius: 5px;
    padding: 4px 10px;
    font-size: 0.9em;
    font-weight: 500;
}

.stMultiSelect [data-baseweb="tag"] svg {
    color: white !important;
}

.stMultiSelect input {
    color: #2f3b4a !important; /* Dark Greyish Blue */
}

/* Blue headers for professional look */
.stMarkdown h1, .stMarkdown h2, .stMarkdown h3, .stMarkdown h4, .stMarkdown h5, .stMarkdown h6 {
    color: #004DA8 !important;
}

/* Professional file uploader styling */
.stFileUploader label {
    color: #2f3b4a !important;
    font-weight: 600;
}

.stFileUploader > div > div {
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
    border: 2px dashed #90caf9;
    border-radius: 8px;
    transition: all 0.3s ease;
    color: #2f3b4a !important;
}

.stFileUploader > div > div:hover {
    border-color: #e0e0e0;
    background: linear-gradient(135deg, #f8fbff 0%, #e3f2fd 100%);
}

.stFileUploader [data-testid="stFileUploaderDropzone"] {
    color: #2f3b4a !important;
}

/* Professional selectbox styling */
.stSelectbox label {
    color: #2c3e50 !important;
    font-weight: 600;
}

.stSelectbox > div > div {
    border-radius: 8px;
    border: 1px solid #acadad;
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
    color: #2c3e50 !important;
}

.stSelectbox > div > div:focus-within {
    border-color: #e0e0e0;
    box-shadow: 0 0 0 0.2rem rgba(0, 77, 168, 0.25);
}

.stSelectbox [data-baseweb="select"] {
    color: #2c3e50 !important;
}

/* Other Inputs styling (Slider, Number, Checkbox, Radio) */
.stSlider label {
    color: #2c3e50 !important;
    font-weight: 600;
}

.stSlider [data-baseweb="slider"] {
    background: #e3f2fd !important;
}

.stSlider [data-baseweb="slider"] [data-testid="stSlider"] {
    color: #004DA8 !important;
}

.stNumberInput label {
    color: #2c3e50 !important;
    font-weight: 600;
}

.stNumberInput input {
    border-radius: 8px;
    border: 1px solid #acadad;
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
    color: #2c3e50 !important;
}

.stNumberInput input:focus {
    border-color: #e0e0e0;
    box-shadow: 0 0 0 0.2rem rgba(0, 77, 168, 0.25);
}

.stCheckbox label {
    color: #2c3e50 !important;
    font-weight: 500;
}

.stRadio label {
    color: #2c3e50 !important;
    font-weight: 600;
}

.stRadio [data-testid="stRadio"] > div {
    color: #2c3e50 !important;
}

.stDateInput label {
    color: #2c3e50 !important;
    font-weight: 600;
}

.stDateInput input {
    border-radius: 8px;
    border: 1px solid #acadad;
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
    color: #2c3e50 !important;
}

.stDateInput input:focus {
    border-color: #e0e0e0;
    box-shadow: 0 0 0 0.2rem rgba(0, 77, 168, 0.25);
}

.stTimeInput label {
    color: #2c3e50 !important;
    font-weight: 600;
}

.stTimeInput input {
    border-radius: 8px;
    border: 1px solid #acadad;
    background: linear-gradient(135deg, #ffffff 0%, #f8fbff 100%);
    color: #2c3e50 !important;
}

.stTimeInput input:focus {
    border-color: #e0e0e0;
    box-shadow: 0 0 0 0.2rem rgba(0, 77, 168, 0.25);
}

/* --- CUSTOM HEADERS CONTAINER (From App CSS) --- */
.header-container {
    padding: 1rem 0;
}

.header-bar {
    display: flex;
    align-items: center;
    gap: 1rem;
    background-color: white;
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.header-title {
    font-size: 2.5rem;
    font-weight: 750;
    color: #004DA8 !important;
    font-family: 'Segoe UI', sans-serif;
    margin: 0;
}

.header-bar img {
    height: 100px;
}

.formula-table {
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    overflow: hidden;
    background-color: white;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 1rem;
}

.formula-table-header {
    background-color: #f8f9fa;
    border-bottom: 2px solid #e0e0e0;
    padding: 0.75rem;
    font-weight: 600;
    font-size: 1.1rem;
    color: #004DA8;
}

.formula-row {
    padding: 0.5rem 0.75rem;
    border-bottom: 1px solid #e0e0e0;
}

.formula-row:last-child {
    border-bottom: none;
}

.formula-row:hover {
    background-color: #f8f9fa;
}

.add-formula-section {
    margin-top: 1rem;
    padding: 1rem;
    background-color: transparent;
    border: none;
}

.add-formula-title {
    font-size: 1.2rem;
    font-weight: 600;
    color: #004DA8;
    margin-bottom: 1rem;
}

.section-divider {
    margin: 2rem 0;
    border-bottom: 1px solid #e0e0e0;
}

/* --- ADDITIONS FOR VARIABLE MAPPING COMPATIBILITY --- */

/* 1. Make the "Start Automatic Mapping" button much more obvious */
div.stButton > button[key="start_mapping_btn"] {
    background: linear-gradient(90deg, #004DA8 0%, #0069d9 100%) !important;
    width: 100% !important;
    height: 50px !important;
    font-size: 20px !important;
    font-weight: 800 !important;
    box-shadow: 0 4px 15px rgba(0, 77, 168, 0.6);
    text-align: center;
    border: 2px solid #003366;
    color: white !important;
}

/* 2. Confidence Badges */
.confidence-high {
    background-color: #d4edda !important;
    color: #155724 !important;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: 600;
}

.confidence-medium {
    background-color: #fff3cd !important;
    color: #856404 !important;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: 600;
}

.confidence-low {
    background-color: #f8d7da !important;
    color: #721c24 !important;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: 600;
}

.header-unmapped {
    background-color: #e8f4f8 !important;
    color: #0277bd !important;
    padding: 4px 8px;
    border-radius: 4px;
    font-style: italic;
}